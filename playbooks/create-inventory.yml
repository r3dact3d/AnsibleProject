---
- name: Create Inventory and Targets
  hosts: localhost
  gather_facts: false
  vars:
    target_inventory: inventory
  tasks:
    - name: Create list from data file
      ansible.builtin.set_fact:
        targets: "{{ lookup('file', '../targets.txt').split('\n') }}"

    - name: Write the inventory file
      ansible.builtin.template:
        mode: '0644'
        src: ../templates/inventory.j2
        dest: "{{ target_inventory }}"
